\documentclass[12pt]{article}
\usepackage{amsmath, amssymb, bm, geometry, graphicx}
\usepackage{hyperref}
\geometry{margin=1in}
\title{\textbf{\huge Programming in Economics \& Finance II, Final Project}}
\author{Niccol√≤ Lecce, Marco Gasparetti, Alessandro Dodon}
\date{}

\begin{document}

\maketitle

\section*{Project Title: Python Package for Efficient VaR Estimation}

This document presents the mathematical models for Value-at-Risk (VaR) and Expected Shortfall (ES) used in our Python package for efficient VaR estimation. The package implements different volatility models to estimate VaR and ES for financial portfolios. We focus on both univariate models for individual assets and multivariate models for portfolios. The following models are implemented:

\section*{Models}

\vspace{0.5cm} % Add a bit of space between models

\textbf{GARCH(p, q) VaR:}  
The Generalized AutoRegressive Conditional Heteroskedasticity (GARCH) model captures volatility clustering:
\[
r_t = \mu + \varepsilon_t, \quad \varepsilon_t = \sigma_t z_t
\]
\[
\sigma_t^2 = \omega + \sum_{i=1}^q \alpha_i \varepsilon_{t-i}^2 + \sum_{j=1}^p \beta_j \sigma_{t-j}^2
\]
\[
\text{VaR}_t = -\hat{\sigma}_t \cdot z_\alpha
\]

\vspace{0.5cm} % Add space between models

\textbf{EGARCH(p, q) VaR:}  
The Exponential GARCH (EGARCH) model captures asymmetries in volatility:
\[
\log(\sigma_t^2) = \omega + \sum_{i=1}^q \beta_i \log(\sigma_{t-i}^2) + \sum_{j=1}^p \alpha_j \left( \frac{|\varepsilon_{t-j}|}{\sigma_{t-j}} - \mathbb{E}\left[ \frac{|\varepsilon_{t-j}|}{\sigma_{t-j}} \right] \right) + \gamma_j \frac{\varepsilon_{t-j}}{\sigma_{t-j}}
\]
\[
\text{VaR}_t = -\hat{\sigma}_t \cdot z_\alpha
\]

\vspace{0.5cm}

\textbf{GJR-GARCH(p, q) VaR:}  
The GJR-GARCH model captures leverage effects where volatility is more sensitive to negative shocks:
\[
\sigma_t^2 = \omega + \sum_{i=1}^q \alpha_i \varepsilon_{t-i}^2 + \sum_{j=1}^p \beta_j \sigma_{t-j}^2 + \sum_{i=1}^q \gamma_i \varepsilon_{t-i}^2 \cdot \mathbb{I}_{\{\varepsilon_{t-i}<0\}}
\]
\[
\text{VaR}_t = -\hat{\sigma}_t \cdot z_\alpha
\]

\vspace{0.5cm}

\textbf{APARCH(p, q) VaR:}  
The Asymmetric Power ARCH (APARCH) model incorporates asymmetry and power effects in volatility:
\[
\sigma_t^\delta = \omega + \sum_{i=1}^q \alpha_i (|\varepsilon_{t-i}| - \gamma_i \varepsilon_{t-i})^\delta + \sum_{j=1}^p \beta_j \sigma_{t-j}^\delta
\]
\[
\text{VaR}_t = -\hat{\sigma}_t \cdot z_\alpha
\]

\vspace{0.5cm}

\textbf{ARCH(p) VaR:}  
The simplest volatility model, the Autoregressive Conditional Heteroskedasticity (ARCH) model, is given by:
\[
\sigma_t^2 = \omega + \sum_{i=1}^p \alpha_i \varepsilon_{t-i}^2
\]
\[
\text{VaR}_t = -\hat{\sigma}_t \cdot z_\alpha
\]

\vspace{0.5cm}

\textbf{EWMA VaR:}  
The Exponentially Weighted Moving Average (EWMA) model applies an exponential decay to past volatilities:
\[
\sigma_t^2 = \lambda \sigma_{t-1}^2 + (1 - \lambda) r_{t-1}^2
\]
\[
\text{VaR}_t = -\hat{\sigma}_t \cdot z_\alpha
\]

\vspace{0.5cm}

\textbf{MA VaR:}  
The Moving Average (MA) model computes volatility as the rolling average of squared returns:
\[
\sigma_t = \sqrt{ \frac{1}{n} \sum_{i=1}^n r_{t-i}^2 }
\]
\[
\text{VaR}_t = -\hat{\sigma}_t \cdot z_\alpha
\]

\vspace{0.5cm}

\textbf{Expected Shortfall (ES):}  
The Expected Shortfall (ES) is the average loss beyond the VaR threshold:
\[
\text{ES}_t = -\hat{\sigma}_t \cdot \mathbb{E}[z_t \mid z_t < z_\alpha]
\]

\vspace{0.5cm}

\textbf{GARCH(1,1) Variance Forecast:}  
Forecasting the conditional variance using the GARCH(1,1) model:
\[
\mathbb{E}[\sigma_{t+T}^2] = \text{VL} + (\alpha + \beta)^T (\sigma_t^2 - \text{VL})
\]
Where \(\text{VL} = \frac{\omega}{1 - \alpha - \beta}\) is the long-run variance.

\vspace{0.5cm}

\textbf{Cumulative GARCH(1,1) Variance Forecast:}  
Cumulative variance forecast over multiple periods:
\[
\mathbb{E}[\sigma_{t,T}^2] = \text{VL} \left( T - 1 - \frac{(\alpha + \beta)(1 - (\alpha + \beta)^{T - 1})}{1 - (\alpha + \beta)} \right) + \sigma_t^2 \cdot \frac{1 - (\alpha + \beta)^T}{1 - (\alpha + \beta)}
\]

\vspace{0.5cm}

\textbf{GARCH(1,1) VaR Forecast:}  
Forecasting the VaR for a given time horizon:
\[
\text{VaR}_{t,T} = - z_\alpha \cdot \sqrt{\mathbb{E}[\sigma_{t,T}^2]}
\]
The quantile \(z_\alpha\) can be derived from the normal distribution or fit to residuals for non-normal distributions.

\vspace{0.5cm}

\textbf{Portfolio Risk Decomposition:}  
Decomposing the portfolio VaR and individual contributions:
\[
\text{VaR}_t = z_\alpha \cdot \sqrt{x_t^\top \Sigma x_t} \cdot \sqrt{h}
\]
\[
\text{UVaR}_t = z_\alpha \cdot \sum_{i=1}^N \sigma_i x_{i,t} \cdot \sqrt{h}
\]
\[
\Delta \text{VaR}_{i,t} = \text{VaR}_t \cdot \frac{(\Sigma x_t)_i}{x_t^\top \Sigma x_t}
\]
\[
\text{CVaR}_{i,t} = x_{i,t} \cdot \Delta \text{VaR}_{i,t}
\]
\[
\text{RCVaR}_{i,t} = \frac{\text{CVaR}_{i,t}}{\text{VaR}_t}
\]
Where \( \Sigma \) is the covariance matrix and \(x_t\) represents the portfolio weights.

\vspace{0.5cm}

\textbf{Expected Shortfall Extensions:}  
\textbf{Historical ES:}
\[
\text{ES} = -\mathbb{E}[r_t \mid r_t < -\text{VaR}_\alpha]
\]
\textbf{Parametric ES (Normal):}
\[
\text{ES}_{\text{normal}} = \sigma \cdot \frac{\phi(z_\alpha)}{1 - \alpha}
\]
\textbf{Parametric ES (Student-t):}
\[
\text{ES}_t = \sigma \cdot \frac{f_{t_\nu}(t_\alpha)}{1 - \alpha} \cdot \frac{\nu + t_\alpha^2}{\nu - 1}
\]
Where \(\phi\) and \(f_{t_\nu}\) are the normal and Student-t PDFs, respectively, and \(\sigma\) is the volatility.

\end{document}
